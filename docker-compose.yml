services:
  web:
    build: .
    container_name: mironova-site
    restart: unless-stopped
    ports:
      - "4343:4343"
    volumes:
      # Данные CMS и загрузки (сохраняются между перезапусками)
      - site-data:/app/data
      - site-uploads:/app/static/uploads
    environment:
      - SECRET_KEY=${SECRET_KEY:-supersecretkey_change_me}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-admin}
      - GIT_USER_NAME=${GIT_USER_NAME:-Admin}
      - GIT_USER_EMAIL=${GIT_USER_EMAIL:-admin@example.com}
      - GIT_REMOTE_URL=${GIT_REMOTE_URL:-}
      - SSH_PRIVATE_KEY=${SSH_PRIVATE_KEY:-}
      - FLASK_ENV=production

volumes:
  site-data:
  site-uploads:
